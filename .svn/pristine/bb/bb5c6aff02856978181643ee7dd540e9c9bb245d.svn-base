package com.kivi.dashboard.shiro.service.impl;

import java.util.List;

import com.kivi.dashboard.shiro.service.ShiroUserService;
import com.kivi.dashboard.sys.entity.SysUserToken;
import com.kivi.dashboard.sys.service.ISysRoleService;
import com.kivi.dashboard.sys.service.ISysUserEnterpriseService;
import com.kivi.dashboard.sys.service.ISysUserService;
import com.kivi.dashboard.sys.service.ISysUserTokenService;
import com.kivi.framework.converter.BeanConverter;
import com.kivi.framework.vo.RoleVo;
import com.kivi.framework.vo.UserTokenVo;
import com.kivi.framework.vo.UserVo;

public class ShiroUserServiceImpl implements ShiroUserService {

	private final ISysUserService			userService;
	private final ISysRoleService			roleService;
	private final ISysUserEnterpriseService	userEnterpriseService;
	private final ISysUserTokenService		userTokenService;

	public ShiroUserServiceImpl(ISysUserService userService, ISysRoleService roleService,
			ISysUserEnterpriseService userEnterpriseService, ISysUserTokenService userTokenService) {
		this.userService			= userService;
		this.roleService			= roleService;
		this.userEnterpriseService	= userEnterpriseService;
		this.userTokenService		= userTokenService;
	}

	@Override
	public UserVo getUserByLoginName(String loginName) {
		return userService.selectByLoginName(loginName);
	}

	@Override
	public RoleVo getRoleById(Long roleId) {
		return roleService.selectByRoleId(roleId);
	}

	@Override
	public List<Long> getEnterpriseIdByUserId(Long userId) {
		return userEnterpriseService.selectEnterpriseIdByUserId(userId);
	}

	@Override
	public UserVo getUserById(Long userId) {
		return userService.selectByUserId(userId);
	}

	@Override
	public UserTokenVo getAccessToken(String accessToken) {
		SysUserToken token = userTokenService.selectByToken(accessToken);
		return BeanConverter.convert(UserTokenVo.class, token);
	}

}
